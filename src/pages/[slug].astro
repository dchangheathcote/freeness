---
import { allTheDatas, getTheSlug } from "../utils/GameData.js";
import MainLayout from "../layouts/MainLayout.astro";
import Footer from "../components/Footer.astro";

export async function getStaticPaths() {
  const gameData = allTheDatas();
  return gameData.map(
    ({
      id,
      title,
      thumbnail,
      status,
      description,
      screenshots,
      game_url,
      platform,
      publisher,
      release_date,
      genre,
    }) => {
      const slug = getTheSlug(title);
      return {
        params: { slug },
        props: {
          id,
          title,
          thumbnail,
          status,
          description,
          screenshots,
          game_url,
          platform,
          publisher,
          release_date,
          genre,
        },
      };
    }
  );
}

const {
  title,
  thumbnail,
  status,
  description,
  screenshots,
  game_url,
  platform,
  publisher,
  release_date,
  genre,
} = Astro.props;
---

<MainLayout title={`${title} - Freeness`}>
  <main>
    <div class="freegame-back-to-home">
      <a href="/">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-6 h-6"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path>
        </svg>
        Back</a
      >
    </div>
    <article>
      <div class="freegame">
        <div class="freegame-main">
          <div class="freegame-side">
            <img src={thumbnail} alt={`${title} thumbnail`} />
          </div>
          <div class="freegame-content">
            <h1>{title}</h1>
            <p class="freegame-genre">{genre}</p>
            <p><a href={game_url} target="_blank">{game_url}</a></p>
            <div class="freegame-meta">
              <p>Platform: {platform}</p>
              <p>Publisher: {publisher}</p>
              <p>{release_date}</p>
            </div>
            <div class="description"><p>{description}</p></div>
            <div class="gallery">
              {screenshots.map((s) => <img src={s.image} alt={s.id} />)}
            </div>
          </div>
        </div>
        <Footer />
      </div>
    </article>
  </main>
</MainLayout>
